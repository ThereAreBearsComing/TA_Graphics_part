# Illumination Models

## 三种着色方式的区别
<img width="114" alt="image" src="https://user-images.githubusercontent.com/74708198/223992711-707f838f-d5f1-4077-a0f0-26ed467f5666.png">

* Flat
  * 一个三角面用一个颜色
  * 每个多边形中只有多边形的面存在法线向量，而其各个顶点没有
  * 在vertex阶段处理光照数据
  * 开销一个面一次

<img width="114" alt="image" src="https://user-images.githubusercontent.com/74708198/223992747-fdc56658-3317-4396-bd02-5cc20287e9f8.png">

* Gouraud
  * 着色时不是对向量进行插值
  * 先计算多边形每个顶点的光照，再通过 **双线性插值** 计算三角形区域中
  * 其它像素的颜色
  * 其多边形的每个顶点都有一个法线向量
  * 在vertex阶段处理光照数据
  * 一个顶点一次

<img width="114" alt="image" src="https://user-images.githubusercontent.com/74708198/223992804-4e046e7f-04d2-495b-90e5-65ee35144306.png">

* Phong
  * 每个片元(fragment)或者说每个像素点计算一次光照
  * 像素点的法线向量是通过顶点的法线向量插值得到的
  * 在fragment阶段处理光照数据
  * 一个像素一次开销

## Flat Shader

* 使用Hard Edge模型，每个三角面的顶点法线是同一个方向
* 使用Soft Edge模型，相邻三角面的顶点法线是同一个方向
  * 编写 Geometry Shader求得每个三角面的面法线，并赋予顶点法线
    * Shader执行顺序
      <br>compute shader -> vertex shader -> tessellation -> geometry shader -> pixel shader
    * 不要超过[maxvertexcount[n]], Append顶点组成三角形的时候注意顺序
  * 使用偏导数 ddx 和 ddy 计算面法线
    * HLSL：ddx(x), ddy(y); GLSL: dFdx(x), dFdy(y)
    * 偏导函数都只能在fragment shader阶段处理
    * 在VertexShader中，将顶点的Pos传入到FragmentShader中
    * 在到FragmentShader中，调用ddx(Pos)和ddy(Pos)求出相邻的2个像素块之间坐标的差值
<br><img width="415" alt="image" src="https://user-images.githubusercontent.com/74708198/224009880-113c9719-04d6-4a5a-af8f-871657031738.png">  <img width="400" alt="image" src="https://user-images.githubusercontent.com/74708198/224009907-df1e7c53-f09e-4825-8065-ade98b95c8f4.png">


