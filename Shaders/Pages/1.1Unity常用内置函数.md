
## Unity常用内置函数
### UnityCG.cginc中一些顶点变换函数：
```HLSL
float4 UnityObjectToClipPos(float3 pos)  // 将点从模型空间转换到相机齐次裁剪坐标空间，等价于mul(UNITY_MATRIX_MVP, float4(pos, 1.0))；
float3 UnityObjectToViewPos(float3 pos)  // 将点从模型空间转换到观察空间，等价于mul(UNITY_MATRIX_MV, float4(pos, 1.0)).xyz
```

### UnityCG.cginc中一些通用的帮助函数：
```HLSL
float3 WorldSpaceViewDir(float4 v)          // 输入一个模型空间中的顶点位置，返回世界空间中从该顶点到摄像机的观察空间方向。 内部使用了UnityWorldSpaceViewDir函数（未归一化）
float3 ObjSpaceViewDir (float4 v)           // 输入一个模型空间中的顶点位置，返回模型空间中从该顶点到摄像机的观察空间方向。

float2 ParallaxOffset (half h, half height, half3 viewDir)  // 计算视差法线贴图的UV偏移量
fixed Luminance (fixed3 c)                  // 将颜色转换为亮度（即灰度）。
fixed3 DecodeLightmap (fixed4 color)        // 从 Unity 解码颜色光照贴图（RGBM 或 dLDR 取决于平台）。
float4 EncodeFloatRGBA (float v)            // 将 [0..1) 范围浮点编码为 RGBA 颜色，用于存储在低精度渲染目标中。
float DecodeFloatRGBA (float4 enc)          // 将 RGBA 颜色解码为浮点数。
float2 EncodeFloatRG (float v)              // 将 [0..1) 范围浮点数编码为 float2。
float DecodeFloatRG (float2 enc)            // 解码先前编码的 RG 浮点数。
float2 EncodeViewNormalStereo (float3 n)    // 将视图空间法线编码为 0..1 范围内的两个数字。
float3 DecodeViewNormalStereo (float4 enc4) // 从 enc4.xy 正常解码视图空间。
```

### UnityCG.cginc 中的前向渲染辅助函数
这些函数只有在使用前向渲染时才可以使用（ForwardBase 或 ForwardAdd 的 pass）。
```HLSL
float3 WorldSpaceLightDir (float4 v)       // 提供模型空间顶点位置，计算世界空间下光方向（未归一化）
float3 ObjSpaceLightDir (float4 v)         // 提供模型空间顶点位置，计算模型空间下光方向（未归一化）
float3 Shade4PointLights (...)             // 计算来自四个点光源的照明，将光数据紧密打包到向量中。前向渲染使用它来计算每个顶点的光照。
```

### UnityCG.cginc 中的屏幕空间辅助函数
以下函数是计算用于采样屏幕空间纹理的坐标的助手。它们返回`float4`可以通过透视除法（例如 ）计算采样纹理的最终坐标`xy/w`。这些函数还**处理了平台差异**渲染纹理坐标。
```HLSL
float4 ComputeScreenPos (float4 clipPos)   // 计算用于执行屏幕空间映射纹理样本的纹理坐标。输入是裁剪空间位置。

float4 ComputeGrabScreenPos (float4 clipPos) // 计算用于采样GrabPass纹理的纹理坐标。输入是裁剪空间位置。
```








