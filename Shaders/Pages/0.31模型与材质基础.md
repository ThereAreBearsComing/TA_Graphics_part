
## 渲染管线与模型基础
* 渲染管线
    * 蓝色背景的：可编程管线
    * 顶点着色器：模型的顶点进行计算
    * 片元着色器：将光栅化阶段插值的信息进行计算，（eg，光照计算）
<br>![image](https://user-images.githubusercontent.com/74708198/236808171-10fd3956-8967-429e-b029-2ff5685ead80.png)

* UV
  * 纹理映射：任何3D物体的表面都是2D的→纹理就是一张图→纹理映射：把这张图蒙在一个3D物体上
  * uv，就是把这张图展开在一个坐标系中，坐标轴为u和v
  * 每个顶点都能利用uv坐标后取到贴图所存储的信息
<br>![image](https://user-images.githubusercontent.com/74708198/236808802-e79b5d71-fdf5-47c4-8c3e-4aaf23b0d36b.png)

* 一个模型包含的信息
  * v：顶点坐标数据（模型空间中单个顶点的xyz坐标）
  * vt（texcoord）：贴图坐标（uv坐标）
  * vn（normal）：顶点法线
  * 顶点色  
**obj和fbx格式对比**
<br>![image](https://user-images.githubusercontent.com/74708198/236808978-b28e2a3f-e208-4e8a-88d0-c16476ff5ccb.png)

## 材质基础
<br>![image](https://user-images.githubusercontent.com/74708198/236809814-efb3b287-f614-46b9-ada2-84a8a5057379.png)
* 漫反射
  * 光朝四面八方反射。
  * （GAMES101）入射的Radiance是均匀的  →  入射和出射的Irradiance相等，并且他俩的Radiance都均匀  →  入射的Radiance和出射的 相等
  * 其中Lambert模型简单的认为各个方向是均匀的

<br>![image](https://user-images.githubusercontent.com/74708198/236809936-6a70f143-2336-43b2-a1d8-4775f0ee13f9.png)
* 光滑镜面反射
  * 入射等于出射
  * 入射光根据表面法线进行反射，并且只有在反射方向有能量，其他方向均为0

<br>![image](https://user-images.githubusercontent.com/74708198/236810106-fafd5303-b27a-49f8-bfc1-dec73b097634.png)
* 粗糙镜面反射
  * 法线偏移比较小，所以反射集中在一个区域，有磨砂质感

<br>![image](https://user-images.githubusercontent.com/74708198/236810720-eea0e0c5-1778-48e0-8526-d6c56701f5e1.png)
* 光滑折射
  * 对于特殊的介质，除了反射外还会发生折射现象
  * 其中，反射和折射的能量多少由Fresnel定律决定：
    * ![image](https://user-images.githubusercontent.com/74708198/236810646-d77a326c-a8d4-4146-ad7f-1fade441ee6e.png)

<br>![image](https://user-images.githubusercontent.com/74708198/236810773-fee0d7ab-8c28-4acd-af43-b4938a6dab04.png)
* 粗糙镜面折射
  * 和粗糙镜面反射类似，也是较重在一个区域

<br>![image](https://user-images.githubusercontent.com/74708198/236811041-fa1e2841-2940-4651-9446-78451f61f899.png)
* 多层材质
  * 除了物体本身的材质以外，表面还有东西（可以看到材质本身和表面的一层）

<br>![image](https://user-images.githubusercontent.com/74708198/236811422-49290503-1386-4d69-933e-1890e7317f97.png)
* 次表面散射 SSS（BSSRDF）
  * 把皮肤看做三层：油脂层（高光）、表皮层（颜色）、真皮层

## 模型数据解析（在渲染管线中的作用）
* 顶点动画
  * 顶点着色器计算的是模型的每个顶点，每个顶点数据不同
    * 因此在同个计算公式下，不同的顶点会得出不同的结果
  * 顶点动画就是在顶点shader中对模型的顶点进行操作，来产生动画效果。
  * 需要一定数量的顶点，顶点动画的效果才会明显（必要时可以结合曲面细分）
  * 一个顶点传入顶点shader，顶点shader控制顶点位置时，所有的顶点都会进行一样的算法。
  * 在一些三维软件中，动画的K帧也是顶点动画
    * 意思类似：（GAMES101对于shader概念的完善：每个顶点/像素都会执行一次，是通用的，不用做循环）

* 纹理动画
  * 渲染的过程中改变纹理坐标，使其采样时发生偏移，来达到动画的效果  （eg： UE4中的panner节点可以获取纹理坐标并进行位移）
  * 一般uv偏移都放在顶点shader做，个人总结原因有二：
    * 依赖纹理读取的存在，会影响性能（只要不是从顶点shader直接传到片元shader，就会产生依赖纹理读取）
    * 一般情况下顶点数<片元数，执行次数少
  * 一个效果列举：
  * ![image](https://user-images.githubusercontent.com/74708198/236812992-864aa50b-9a90-45ae-999c-8f952b3353a4.png)
  * 例子原理分析：
    * 第一个部分：光照计算
      * 利用法线贴图，改变反射和折射的朝向
      * ![image](https://user-images.githubusercontent.com/74708198/236813134-f0c111e9-ffa5-44a9-832f-8db687db820c.png)
    * 第二个部分：对背部画面采样的部分
      * 改变uv采样点的位置，产生动画效果
      * ![image](https://user-images.githubusercontent.com/74708198/236813375-e16206c9-d4b5-4d61-87d6-56fcac1cafa1.png)

* 顶点色
  * 可以通过判断顶点色，来做一些操作
    * eg，顶点色达到一定的值，就做阴影。
    * eg2：庄懂老师的课后部分的案例里，使用模型的顶点色作为mask使用
  * Maya中顶点色的绘制
    * （所有四边面转到游戏引擎中都会转换为三角形来计算）
    * ![image](https://user-images.githubusercontent.com/74708198/236818438-25c63fd1-576b-43b5-b527-42c6d41e5f4b.png)
    * `（GAMES101-几何部分）：在图形学中，最常用三角形面来形成物体`

* 插值：重心坐标。
  * 总结：三角形所在平面任意点（x，y）都可用三顶点（α β γ）的线性组合表示。
  * 补充：重心坐标不能保证投影后不变，所以三维情况下要先找到重心坐标再插值
  * 任意一个点的表示公式:
    * ![image](https://user-images.githubusercontent.com/74708198/236818784-ea159f3b-e019-4ffa-93e8-e894ea8145e3.png)
  * 利用这个公式可以得到当前像素点的顶点颜色、法线、纹理坐标，然后就能通过周围三个顶点进行插值
  * 一个例子：重心坐标颜色插值
    * ![image](https://user-images.githubusercontent.com/74708198/236818887-2340fd0f-1575-4be8-b72c-e4865ed1f538.png)

* 顶点法线、面法线
* ![image](https://user-images.githubusercontent.com/74708198/236818957-637498c2-85a9-4c86-a865-1496a3b67ce5.png)
  * 面法线本质上还是顶点法线，只是存储方式不同
  * 原理：
    * 面法线：三个顶点共用一个法线，插值出来结果相同
    * 顶点法线：每个顶点都有一个发现，插值出来也就不同
    * ![image](https://user-images.githubusercontent.com/74708198/236819099-33a483eb-b406-4625-aab2-98a965aea6df.png)

* 扩展：NPR中的描边
  * NPR渲染中，通常在顶点shader中，将顶点法线方向偏移，再在片元着色器中直接输出一个颜色，达到描边效果。
  * BackFacing描边时，描边线条断开就是因为没有平滑顶点之间的法线导致的。 






